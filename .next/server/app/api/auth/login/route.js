"use strict";(()=>{var e={id:873,ids:[873]};e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5228:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>de,patchFetch:()=>pe,requestAsyncStorage:()=>ne,routeModule:()=>ae,serverHooks:()=>ce,staticGenerationAsyncStorage:()=>ie});var o={};r.r(o),r.d(o,{POST:()=>se});var s=r(49303),a=r(88716),n=r(60670),i=r(87070);const c=require("node:buffer");const d=e=>c.Buffer.from(e).toString("base64url"),p=require("node:crypto"),h=require("node:util");class u extends Error{static code="ERR_JOSE_GENERIC";code="ERR_JOSE_GENERIC";constructor(e,t){super(e,t),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class y extends u{static code="ERR_JOSE_NOT_SUPPORTED";code="ERR_JOSE_NOT_SUPPORTED"}class l extends u{static code="ERR_JWS_INVALID";code="ERR_JWS_INVALID"}class f extends u{static code="ERR_JWT_INVALID";code="ERR_JWT_INVALID"}Symbol.asyncIterator;const m=p.webcrypto,w=e=>h.types.isCryptoKey(e),S=e=>h.types.isKeyObject(e);function g(e,t,...r){if((r=r.filter(Boolean)).length>2){const t=r.pop();e+=`one of type ${r.join(", ")}, or ${t}.`}else 2===r.length?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return null==t?e+=` Received ${t}`:"function"===typeof t&&t.name?e+=` Received function ${t.name}`:"object"===typeof t&&null!=t&&t.constructor?.name&&(e+=` Received an instance of ${t.constructor.name}`),e}const b=(e,...t)=>g("Key must be ",e,...t);function E(e,t,...r){return g(`Key for the ${e} algorithm must be `,t,...r)}const _=e=>S(e)||w(e),T=["KeyObject"];function v(e){if("object"!==typeof(t=e)||null===t||"[object Object]"!==Object.prototype.toString.call(e))return!1;var t;if(null===Object.getPrototypeOf(e))return!0;let r=e;for(;null!==Object.getPrototypeOf(r);)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r}function k(e){return v(e)&&"string"===typeof e.kty}(globalThis.CryptoKey||m?.CryptoKey)&&T.push("CryptoKey");new WeakMap;const H=(e,t)=>{let r;if(w(e))r=p.KeyObject.from(e);else{if(!S(e)){if(k(e))return e.crv;throw new TypeError(b(e,...T))}r=e}if("secret"===r.type)throw new TypeError('only "private" or "public" type keys can be used for this operation');switch(r.asymmetricKeyType){case"ed25519":case"ed448":return`Ed${r.asymmetricKeyType.slice(2)}`;case"x25519":case"x448":return`X${r.asymmetricKeyType.slice(1)}`;case"ec":{const e=r.asymmetricKeyDetails.namedCurve;return t?e:(e=>{switch(e){case"prime256v1":return"P-256";case"secp384r1":return"P-384";case"secp521r1":return"P-521";case"secp256k1":return"secp256k1";default:throw new y("Unsupported key curve for this operation")}})(e)}default:throw new TypeError("Invalid asymmetric key type for this operation")}},P=(e,t)=>{let r;try{r=e instanceof p.KeyObject?e.asymmetricKeyDetails?.modulusLength:Buffer.from(e.n,"base64url").byteLength<<3}catch{}if("number"!==typeof r||r<2048)throw new TypeError(`${t} requires key modulusLength to be 2048 bits or larger`)},A=new Map([["ES256","P-256"],["ES256K","secp256k1"],["ES384","P-384"],["ES512","P-521"]]);function K(e,t="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function R(e,t){return e.name===t}function $(e){return parseInt(e.name.slice(4),10)}function O(e,t){if(t.length&&!t.some((t=>e.usages.includes(t)))){let e="CryptoKey does not support this operation, its usages must include ";if(t.length>2){const r=t.pop();e+=`one of ${t.join(", ")}, or ${r}.`}else 2===t.length?e+=`one of ${t[0]} or ${t[1]}.`:e+=`${t[0]}.`;throw new TypeError(e)}}function I(e,t,...r){switch(t){case"HS256":case"HS384":case"HS512":{if(!R(e.algorithm,"HMAC"))throw K("HMAC");const r=parseInt(t.slice(2),10);if($(e.algorithm.hash)!==r)throw K(`SHA-${r}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!R(e.algorithm,"RSASSA-PKCS1-v1_5"))throw K("RSASSA-PKCS1-v1_5");const r=parseInt(t.slice(2),10);if($(e.algorithm.hash)!==r)throw K(`SHA-${r}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!R(e.algorithm,"RSA-PSS"))throw K("RSA-PSS");const r=parseInt(t.slice(2),10);if($(e.algorithm.hash)!==r)throw K(`SHA-${r}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==e.algorithm.name&&"Ed448"!==e.algorithm.name)throw K("Ed25519 or Ed448");break;case"ES256":case"ES384":case"ES512":{if(!R(e.algorithm,"ECDSA"))throw K("ECDSA");const r=function(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}(t);if(e.algorithm.namedCurve!==r)throw K(r,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}O(e,r)}const j=(0,h.promisify)(p.sign),x=async(e,t,r)=>{const o=function(e,t,r){if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw new TypeError(b(t,...T));return(0,p.createSecretKey)(t)}if(t instanceof p.KeyObject)return t;if(w(t))return I(t,e,r),p.KeyObject.from(t);if(k(t))return e.startsWith("HS")?(0,p.createSecretKey)(Buffer.from(t.k,"base64url")):t;throw new TypeError(b(t,...T,"Uint8Array","JSON Web Key"))}(e,t,"sign");if(e.startsWith("HS")){const t=p.createHmac(function(e){switch(e){case"HS256":return"sha256";case"HS384":return"sha384";case"HS512":return"sha512";default:throw new y(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}(e),o);return t.update(r),t.digest()}return j(function(e){switch(e){case"PS256":case"RS256":case"ES256":case"ES256K":return"sha256";case"PS384":case"RS384":case"ES384":return"sha384";case"PS512":case"RS512":case"ES512":return"sha512";case"EdDSA":return;default:throw new y(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}(e),r,function(e,t){let r,o,s,a;if(t instanceof p.KeyObject)r=t.asymmetricKeyType,o=t.asymmetricKeyDetails;else switch(s=!0,t.kty){case"RSA":r="rsa";break;case"EC":r="ec";break;case"OKP":if("Ed25519"===t.crv){r="ed25519";break}if("Ed448"===t.crv){r="ed448";break}throw new TypeError("Invalid key for this operation, its crv must be Ed25519 or Ed448");default:throw new TypeError("Invalid key for this operation, its kty must be RSA, OKP, or EC")}switch(e){case"EdDSA":if(!["ed25519","ed448"].includes(r))throw new TypeError("Invalid key for this operation, its asymmetricKeyType must be ed25519 or ed448");break;case"RS256":case"RS384":case"RS512":if("rsa"!==r)throw new TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");P(t,e);break;case"PS256":case"PS384":case"PS512":if("rsa-pss"===r){const{hashAlgorithm:t,mgf1HashAlgorithm:r,saltLength:s}=o,a=parseInt(e.slice(-3),10);if(void 0!==t&&(t!==`sha${a}`||r!==t))throw new TypeError(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${e}`);if(void 0!==s&&s>a>>3)throw new TypeError(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${e}`)}else if("rsa"!==r)throw new TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa or rsa-pss");P(t,e),a={padding:p.constants.RSA_PKCS1_PSS_PADDING,saltLength:p.constants.RSA_PSS_SALTLEN_DIGEST};break;case"ES256":case"ES256K":case"ES384":case"ES512":{if("ec"!==r)throw new TypeError("Invalid key for this operation, its asymmetricKeyType must be ec");const o=H(t),s=A.get(e);if(o!==s)throw new TypeError(`Invalid key curve for the algorithm, its curve must be ${s}, got ${o}`);a={dsaEncoding:"ieee-p1363"};break}default:throw new y(`alg ${e} is not supported either by JOSE or your javascript runtime`)}return s?{format:"jwk",key:t,...a}:a?{...a,key:t}:t}(e,o))},J=(...e)=>{const t=e.filter(Boolean);if(0===t.length||1===t.length)return!0;let r;for(const o of t){const e=Object.keys(o);if(r&&0!==r.size)for(const t of e){if(r.has(t))return!1;r.add(t)}else r=new Set(e)}return!0},C=new TextEncoder,W=new TextDecoder;function N(...e){const t=e.reduce(((e,{length:t})=>e+t),0),r=new Uint8Array(t);let o=0;for(const s of e)r.set(s,o),o+=s.length;return r}const D=e=>e?.[Symbol.toStringTag],M=(e,t,r)=>{if(void 0!==t.use&&"sig"!==t.use)throw new TypeError("Invalid key for this operation, when present its use must be sig");if(void 0!==t.key_ops&&!0!==t.key_ops.includes?.(r))throw new TypeError(`Invalid key for this operation, when present its key_ops must include ${r}`);if(void 0!==t.alg&&t.alg!==e)throw new TypeError(`Invalid key for this operation, when present its alg must be ${e}`);return!0},U=(e,t,r,o)=>{if(!(t instanceof Uint8Array)){if(o&&k(t)){if(function(e){return k(e)&&"oct"===e.kty&&"string"===typeof e.k}(t)&&M(e,t,r))return;throw new TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!_(t))throw new TypeError(E(e,t,...T,"Uint8Array",o?"JSON Web Key":null));if("secret"!==t.type)throw new TypeError(`${D(t)} instances for symmetric algorithms must be of type "secret"`)}};function L(e,t,r,o){t.startsWith("HS")||"dir"===t||t.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(t)?U(t,r,o,e):((e,t,r,o)=>{if(o&&k(t))switch(r){case"sign":if(function(e){return"oct"!==e.kty&&"string"===typeof e.d}(t)&&M(e,t,r))return;throw new TypeError("JSON Web Key for this operation be a private JWK");case"verify":if(function(e){return"oct"!==e.kty&&"undefined"===typeof e.d}(t)&&M(e,t,r))return;throw new TypeError("JSON Web Key for this operation be a public JWK")}if(!_(t))throw new TypeError(E(e,t,...T,o?"JSON Web Key":null));if("secret"===t.type)throw new TypeError(`${D(t)} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===r&&"public"===t.type)throw new TypeError(`${D(t)} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===r&&"public"===t.type)throw new TypeError(`${D(t)} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&"verify"===r&&"private"===t.type)throw new TypeError(`${D(t)} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&"encrypt"===r&&"private"===t.type)throw new TypeError(`${D(t)} instances for asymmetric algorithm encryption must be of type "public"`)})(t,r,o,e)}L.bind(void 0,!1);const q=L.bind(void 0,!0);const G=function(e,t,r,o,s){if(void 0!==s.crit&&void 0===o?.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!o||void 0===o.crit)return new Set;if(!Array.isArray(o.crit)||0===o.crit.length||o.crit.some((e=>"string"!==typeof e||0===e.length)))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let a;a=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t;for(const n of o.crit){if(!a.has(n))throw new y(`Extension Header Parameter "${n}" is not recognized`);if(void 0===s[n])throw new e(`Extension Header Parameter "${n}" is missing`);if(a.get(n)&&void 0===o[n])throw new e(`Extension Header Parameter "${n}" MUST be integrity protected`)}return new Set(o.crit)};class B{_payload;_protectedHeader;_unprotectedHeader;constructor(e){if(!(e instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(e,t){if(!this._protectedHeader&&!this._unprotectedHeader)throw new l("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!J(this._protectedHeader,this._unprotectedHeader))throw new l("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const r={...this._protectedHeader,...this._unprotectedHeader};let o=!0;if(G(l,new Map([["b64",!0]]),t?.crit,this._protectedHeader,r).has("b64")&&(o=this._protectedHeader.b64,"boolean"!==typeof o))throw new l('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:s}=r;if("string"!==typeof s||!s)throw new l('JWS "alg" (Algorithm) Header Parameter missing or invalid');q(s,e,"sign");let a,n=this._payload;o&&(n=C.encode(d(n))),a=this._protectedHeader?C.encode(d(JSON.stringify(this._protectedHeader))):C.encode("");const i=N(a,C.encode("."),n),c=await x(s,e,i),p={signature:d(c),payload:""};return o&&(p.payload=W.decode(n)),this._unprotectedHeader&&(p.header=this._unprotectedHeader),this._protectedHeader&&(p.protected=W.decode(a)),p}}class V{_flattened;constructor(e){this._flattened=new B(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,t){const r=await this._flattened.sign(e,t);if(void 0===r.payload)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${r.protected}.${r.payload}.${r.signature}`}}const F=e=>Math.floor(e.getTime()/1e3),z=86400,X=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i,Q=e=>{const t=X.exec(e);if(!t||t[4]&&t[1])throw new TypeError("Invalid time period format");const r=parseFloat(t[2]);let o;switch(t[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":o=Math.round(r);break;case"minute":case"minutes":case"min":case"mins":case"m":o=Math.round(60*r);break;case"hour":case"hours":case"hr":case"hrs":case"h":o=Math.round(3600*r);break;case"day":case"days":case"d":o=Math.round(r*z);break;case"week":case"weeks":case"w":o=Math.round(604800*r);break;default:o=Math.round(31557600*r)}return"-"===t[1]||"ago"===t[4]?-o:o};function Y(e,t){if(!Number.isFinite(t))throw new TypeError(`Invalid ${e} input`);return t}class Z{_payload;constructor(e={}){if(!v(e))throw new TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return"number"===typeof e?this._payload={...this._payload,nbf:Y("setNotBefore",e)}:e instanceof Date?this._payload={...this._payload,nbf:Y("setNotBefore",F(e))}:this._payload={...this._payload,nbf:F(new Date)+Q(e)},this}setExpirationTime(e){return"number"===typeof e?this._payload={...this._payload,exp:Y("setExpirationTime",e)}:e instanceof Date?this._payload={...this._payload,exp:Y("setExpirationTime",F(e))}:this._payload={...this._payload,exp:F(new Date)+Q(e)},this}setIssuedAt(e){return"undefined"===typeof e?this._payload={...this._payload,iat:F(new Date)}:e instanceof Date?this._payload={...this._payload,iat:Y("setIssuedAt",F(e))}:this._payload="string"===typeof e?{...this._payload,iat:Y("setIssuedAt",F(new Date)+Q(e))}:{...this._payload,iat:Y("setIssuedAt",e)},this}}class ee extends Z{_protectedHeader;setProtectedHeader(e){return this._protectedHeader=e,this}async sign(e,t){const r=new V(C.encode(JSON.stringify(this._payload)));if(r.setProtectedHeader(this._protectedHeader),Array.isArray(this._protectedHeader?.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new f("JWTs MUST NOT use unencoded payload");return r.sign(e,t)}}const te=(new TextEncoder).encode(process.env.JWT_SECRET||"default-secret-key"),re="HS256";async function oe(e,t){return"admin"===e&&"admin123"===t?async function(e){return new ee(e).setProtectedHeader({alg:re}).setIssuedAt().setExpirationTime("24h").sign(te)}({username:e}):null}async function se(e){try{const{username:t,password:r}=await e.json(),o=await oe(t,r);return o?i.NextResponse.json({token:o}):i.NextResponse.json({error:"Invalid credentials"},{status:401})}catch(t){return i.NextResponse.json({error:"Internal server error"},{status:500})}}const ae=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"G:\\Websites\\1-new_design\\Gen4\\by1-local\\app\\api\\auth\\login\\route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:ne,staticGenerationAsyncStorage:ie,serverHooks:ce}=ae,de="/api/auth/login/route";function pe(){return(0,n.patchFetch)({serverHooks:ce,staticGenerationAsyncStorage:ie})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=t.X(0,[948,972],(()=>{return e=5228,t(t.s=e);var e}));module.exports=r})();